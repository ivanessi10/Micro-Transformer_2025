# Gemma Russian SuperGLUE - –§–∏–Ω–∞–ª—å–Ω—ã–µ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üìä –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –ø–æ –∑–∞–¥–∞—á–∞–º:
- **LIDIRUS** (Natural Language Inference): 44.0% accuracy, 43.18% F1
- **PARUS** (Choice of Plausible Alternatives): 50.0% accuracy, 49.82% F1  
- **RCB** (Reading Comprehension): 42.0% accuracy, 42.29% F1

**–°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å: 45.33%**

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ú–æ–¥–µ–ª–∏

### –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å:
- **google/gemma-3-1b-it** (1.34B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è Apple Silicon (MPS)

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –≥–æ–ª–æ–≤—ã:
- **LIDIRUS**: 2 –∫–ª–∞—Å—Å–∞ (entailment/not_entailment)
- **PARUS**: 2 –∫–ª–∞—Å—Å–∞ (choice_0/choice_1)
- **RCB**: 3 –∫–ª–∞—Å—Å–∞ (entailment/contradiction/neutral)

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
- –ó–∞–º–æ—Ä–æ–∑–∫–∞ 12 –∏–∑ 26 —Å–ª–æ–µ–≤ –º–æ–¥–µ–ª–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ float32 –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å MPS
- Gradient accumulation steps: 8
- Learning rate: 5e-5

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
/Users/ivanpetrusa/Desktop/micro/Gemma/
‚îú‚îÄ‚îÄ gemma_rsg_unified.py      # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ test_unified_model.py     # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞
‚îú‚îÄ‚îÄ models/gemma-unified-rsg/ # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –î–∞–Ω–Ω—ã–µ:
- LiDiRus.jsonl (501 –ø—Ä–∏–º–µ—Ä–æ–≤)
- PARus/ (400 train, 100 val, 100 test)
- RCB/ (438 train, 220 val, 438 test)

## üöÄ –û–±—É—á–µ–Ω–∏–µ

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- **–≠–ø–æ—Ö–∏**: 3
- **Batch size**: 2 (—Å gradient accumulation)
- **Optimizer**: AdamW
- **Scheduler**: Linear —Å warmup
- **–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è**: ~30+ –º–∏–Ω—É—Ç –Ω–∞ Apple Silicon

### –ó–∞–º–æ—Ä–æ–∑–∫–∞ —Å–ª–æ–µ–≤:
```python
freeze_layers = 12  # –∏–∑ 26 –æ–±—â–∏—Ö —Å–ª–æ–µ–≤
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **GemmaRSGUnified** - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏ —Å –º—É–ª—å—Ç–∏-–∑–∞–¥–∞—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
2. **RSGUnifiedDataset** - –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –º—É–ª—å—Ç–∏-–∑–∞–¥–∞—á–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
3. **RSGUnifiedTrainer** - –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ç—Ä–µ–π–Ω–µ—Ä —Å –∑–∞–º–æ—Ä–æ–∑–∫–æ–π —Å–ª–æ–µ–≤
4. **Preprocessing** - —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- ‚úÖ Apple Silicon (MPS)
- ‚úÖ PyTorch 2.6+
- ‚úÖ Transformers 4.47+
- ‚úÖ SafeTensors —Ñ–æ—Ä–º–∞—Ç

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ –∑–∞–¥–∞—á–∞–º:
| –ó–∞–¥–∞—á–∞   | Accuracy | F1 Score | –ü—Ä–∏–º–µ—Ä—ã |
|----------|----------|----------|---------|
| LIDIRUS  | 44.0%    | 43.18%   | 501     |
| PARUS    | 50.0%    | 49.82%   | 100     |
| RCB      | 42.0%    | 42.29%   | 438     |

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ü–∞–º—è—Ç—å: ~6-8 GB GPU/MPS
- –í—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞: ~50ms –Ω–∞ –ø—Ä–∏–º–µ—Ä
- –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏: ~1.34B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –£–ª—É—á—à–µ–Ω–∏—è

1. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ø–æ—Ö** (5-10)
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ learning rate** per-task
3. **Data augmentation** —Ç–µ—Ö–Ω–∏–∫–∏
4. **Ensemble –º–µ—Ç–æ–¥—ã**
5. **–ë–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∞—è fine-tuning**

## üí° –í—ã–≤–æ–¥—ã

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–ª —Ä–∞–±–æ—á—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è Gemma –º–æ–¥–µ–ª–∏ –Ω–∞ Russian SuperGLUE benchmark —Å:

- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –¥–ª—è 3 –∑–∞–¥–∞—á
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è Apple Silicon
- ‚úÖ –†–∞–∑—É–º–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (45.33% —Å—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å)
- ‚úÖ –ü–æ–ª–Ω–æ–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å—é
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ö–æ—Ä–æ—à—É—é –±–∞–∑–æ–≤—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è.
